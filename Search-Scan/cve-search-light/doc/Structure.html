<!DOCTYPE html>
<html>
<head>
  <title>CVE-Search structure - CVE-Search</title>

  <meta charset="utf-8">

  <link href="css/style.css" rel="stylesheet" />
</head>
<body>
  <h1>CVE-Search Structure</h1>
  <h2>Mongo Database Structure</h2>
  <p>
    This section describes the structure of the Mongo database. There are two types of collections, data and management.
    The data collections, which are listed below, are the collections that are filled by the sources CVE-Search uses.
    By default, these are the official sources.<br />
    <br />
    These are the data collections:
    <table>
      <thead>
        <tr><td>Collection</td> <td>Source</td> <td>Description</td></tr>
      </thead>
      <tr><td>cves</td> <td>NVD NIST</td> <td>All the official vulnerabilities, released by NIST. Items in this collection have all info related to each CVE</td></tr>
      <tr><td>cpe</td> <td>NVD NIST</td> <td>All the official products, released by NIST. Some of these have a human readable title.</td></tr>
      <tr><td>cpeother</td> <td>CVE-Search</td> <td>CVE-Search has a script to fill this database, using the original CPE's and generating titles for them.</td></tr>
      <tr><td>cwe</td> <td>NVD NIST</td> <td>Information about Common Weaknesses, as published by NIST</td></tr>
      <tr><td>d2sec</td> <td>d2sec.com</td> <td>Information about CVE's, as released by d2sec</td></tr>
      <tr><td>vfeed</td> <td>vFeed</td> <td>Information about CVE's, as released by vFeed</td></tr>
      <tr><td>vendor</td> <td>NVD NIST</td> <td>Vendor statements, released by NIST</td></tr>
      <tr><td>info</td> <td>CVE-Search</td> <td>Information about the Mongo Database updates.</td></tr>
    </table>
    <br />
    These are the management collections:
    <table>
      <thead>
        <tr><td>Collection</td> <td>Description</td></tr>
      </thead>
      <tr><td>ranking</td> <td>Self-set ranking for specific CPE's that are more important to specific groups</td></tr>
      <tr><td>mgmt_blacklist</td> <td>List of CPE's that have to be excluded from the web view. More about this <a href="./Web component.html#admin_pages">here</a></td></tr>
      <tr><td>mgmt_whitelist</td> <td>List of CPE's that have to be marked in the web view. More about this <a href="Webcomponent.html#admin_pages">here</a></td></tr>
      <tr><td>mgmt_users</td> <td>List of users who have access to the administrative panel. More about this <a href="Webcomponent.html#admin_pages">here</a></td></tr>
    </table>
    <br />
    By default, the Mongo database name is cvedb. This connection for the database is made on localhost, port 27017.
  </p>

  <h2>Redis Cache Database</h2>
  <p>
    The Redis Caching server is used to speed up the searches in the web component. It is also used for the notifications script.<br />
    By default, The database used for speeding up the searches is database number 10, and the vendor database is database 11.<br />
    The vendor database (database 10) contains four collections. These are:
    <ul>
      <li>prefix</li>
      <li>types</li>
      <li>vendors</li>
      <li>Products</li>
    </ul>
    These lists get filled by the <span class="code">db_cpe_browser.py</span> script, and create "links" to each other.
    Feel free to take a look at <span class="code">db_cpe_browser.py</span> to learn how it works. <br />
    <br />
    The notifications cache has a structure where it keeps track of:
    <ul>
      <li>Organisations</li>
      <li>CPE's</li>
      <li>MailTo destination</li>
    </ul>
    Feel free to take a look at <span class="code">db_notifications.py</span> to learn how it works. <br />
  </p>
</body>
</html>
